!function(a){var b=cfrequest.rulesEngineExpressions||{},c=function(){function b(a,b){this.$formControl=a,this.model=this.deserialize(this.$formControl.val()),this.expressions=b,this.render()}return b.prototype.persistToHiddenField=function(){this.$formControl.val(this.serialize())},b.prototype.serialize=function(){return JSON.stringify(this.model)},b.prototype.deserialize=function(a){if(this.isValidSerializedCondition(a))try{return JSON.parse(a)}catch(a){}return[]},b.prototype.isValidSerializedCondition=function(b){return"string"==typeof b&&0!==a.trim(b).length},b.prototype.render=function(){console.log("TODO: render stuff")},b.prototype.addExpression=function(a){var b=this.newExpression(a);this.model.length&&this.model.push("and"),this.model.push(b),this.persistToHiddenField(),this.render()},b.prototype.newExpression=function(a){for(var b,c,d,e=this.expressions.length-1;e>=0;e--)if(b=this.expressions[e],b.id.toLowerCase()===a.toLowerCase()){c={expression:b.id,fields:{}};for(d in b.fields)"undefined"==typeof b.fields[d].default?c.fields[d]=null:c.fields[d]=b.fields[d].default;return c}return{}},b.prototype.removeExpression=function(){console.log("TODO: removeExpression() logic"),this.persistToHiddenField(),this.render()},b.prototype.saveExpressionFieldValue=function(){console.log("TODO: saveExpressionFieldValue() logic"),this.persistToHiddenField(),this.render()},b}();a.fn.rulesEngineConditionBuilder=function(){return this.each(function(){var d,e,f,g,h,i,j,k,l=a(this),m=l.next("div.rules-engine-condition-builder"),n=m.find(".rules-engine-condition-builder-expression-search"),o=m.find(".rules-engine-condition-builder-expressions-list"),p=m.find(".rules-engine-condition-builder-condition-pane"),q=(m.find(".rules-engine-condition-builder-rule-list"),o.find("> li")),r=(l.attr("tabindex"),l.val(),b[l.attr("id")]||[]);g=function(){var b=l.attr("id"),g=l.attr("name"),j=(l.attr("tabindex"),l.val());m.removeClass("hide"),n.on("keyup",f),d=a('<input type="hidden">'),d.val(j),d.attr("name",g),l.after(d),l.remove(),d.attr("id",b),e=new c(d,r),h(),i()},h=function(){q.each(function(){var b=a(this);b.data("originalText",b.text())})},f=function(){var b=n.val();q.each(function(){var c=a(this),d=c.data("originalText");b.length?d.toLowerCase().includes(b.toLowerCase())?(c.removeClass("hide"),c.html(d.replace(new RegExp(b,"gi"),function(a){return"<b>"+a+"</b>"}))):c.addClass("hide"):(c.removeClass("hide"),c.html(d))})},i=function(){q.draggable({helper:"clone"}),p.droppable({accept:q,drop:j,hoverClass:"ui-droppable-hover"})},j=function(a,b){var c=b.draggable.clone();e.addExpression(c.data("id"))},k=function(){},g()})},a("textarea.rules-engine-condition-builder").rulesEngineConditionBuilder()}(presideJQuery);
//# sourceMappingURL=_rulesEngineConditionBuilder.min.map